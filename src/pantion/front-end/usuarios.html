<!DOCTYPE html>
<html>

<head>
  <title>Pantion</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
  <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,500' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/usuarios.css">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> <!-- card colaboradores do projeto -->
  <link rel="sortcut icon" href="/images/favicon.png" />
</head>
<script>
  var full_url = document.URL;
  var url_array = full_url.split('/');
  var last_segment = url_array[url_array.length - 1];
</script>

<body>

  <nav class="navbar navbar-expand-lg navbar-light">
    <img src="/images/logo_stext.png" width="60" height="60">
    <span class="color_title">Pantion </span>


    <div class="subnav">
      <a href="/"><button class="subnavbtn">Todos os projetos </button></a>
    </div>

   
    <div class="subnav">
      <a href='/total'><button class="subnavbtn">Informações complementares</button></a>
    </div>
    <div class="subnav">
      <a href="/logout"><button class="logoOff">Sair</button></a>
    </div>
   
  </nav>

  <br>

  <h1 id="nomeProjeto">
    <p id="nome_projeto">Nome do Projeto</p>
  </h1>
  <br>
 
  <hr style="height:1px;border:none;color:#a6a6a6;background-color:#a6a6a6;" />

  <div id=menu_options>
        <label for=panel class="options">
          <a href="" id="visualizar_painel">
          <div>
            <img src="/images/painel.png">
            <b><i>Painel</i></b>
          </div>
        </a>
        </label>
    
        <label for=users class="options">
          <a href="" id="visualizar_usuarios">
            <div>
              <img src="/images/usuarios.png">
              <b><i>Usuários</i></b>
            </div>
        </label>
        </a>

        <label for=graphics class="options">
          <a href="" id="visualizar_graficos">
            <div>
              <img src="/images/grafico.png">
              <b><i>Gráficos</i></b>
            </div>
        </label>
        </a>

         <label for=comments class="options">
       <a href="" id="visualizar_comentarios">
          <div>
            <img src="/images/comments.png">
            <b><i>Comentários</i></b>
          </div>
        </label>
        </a>
  </div>
  <br>

  <div class="card-users" id="users"></div>

  </div>
  </div>
  
  <!-- <div id="voltarTopo">
    <a href="#" id="subir"></a>
  </div>
  <div class="line"></div>
  </div> -->
  <footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!--pode dar conflito-->

    <script>
      var scrt_var = last_segment;
      var strLink = "/usuarios/" + scrt_var;
      document.getElementById("visualizar_usuarios").setAttribute("href", strLink);

      var strLinkGrafico = "/grafico/" + scrt_var;
      document.getElementById("visualizar_graficos").setAttribute("href", strLinkGrafico);

      var strLinkPainel = "/projeto/" + scrt_var;
      document.getElementById("visualizar_painel").setAttribute("href", strLinkPainel);

      var strLinkComentarios = "/comentarios/" + scrt_var;
      document.getElementById("visualizar_comentarios").setAttribute("href", strLinkComentarios);

      $(document).ready(function () {
        $('#subir').click(function () {
          $('html, body').animate({ scrollTop: 0 }, 'slow');
          return false;
        });
      })
      $('#sidebarCollapse').on('click', function () {
        $('#sidebar').toggleClass('active');
      });
      $.ajax({
        url: "http://localhost:3000/pegar_usuarios/:id=" + last_segment,
        type: "GET",
        contentType: "charset=utf-8",
        dataType: "json",
        success: function (data) {

          var nomeDoProjeto = document.getElementById('nome_projeto');
          nomeDoProjeto.textContent = data.rows[0].projeto;

          data.rows.forEach(usuario => {


            var userlist = document.getElementById('users');

            // card col left
            let divColLeft = document.createElement("div");
            divColLeft.classList.add("card-col-left");
            let divAvatarMini = document.createElement("div");
            let avatar_user = document.createElement("img");
            avatar_user.src = '/images/icon-colab.png'; // <-
            avatar_user.style = "height: 80px; width: 80px; border-radius: 50px; margin-right: 25px;";
            divAvatarMini.appendChild(avatar_user);
            divAvatarMini.classList.add("avatar-mini");
            divColLeft.appendChild(divAvatarMini);

            // card col right -----------------
            let ccRight = document.createElement("div");
            ccRight.classList.add("card-col-right");
            // --------------------------------

            // div user name
            let userName = document.createElement("div");
            userName.classList.add("user-name");
            let spanNomeUser = document.createElement("span");
            spanNomeUser.textContent = usuario.user_primeiro_nome + ' ' + usuario.user_ultimo_nome
            userName.appendChild(spanNomeUser);
            ccRight.appendChild(userName);

            // user update -------------------
            let userUpdate = document.createElement("div")
            userUpdate.classList.add("user-update")
            // --------------------------

            //div contato/email
            let divEmail = document.createElement("div");
            divEmail.classList.add("contato");
            let i_Email = document.createElement("i");
            i_Email.classList.add("fas");
            i_Email.classList.add("fa-envelope-open-text");
            let spanEmail = document.createElement("span");
            spanEmail.textContent = " " + usuario.user_email;
            divEmail.appendChild(i_Email);
            divEmail.appendChild(spanEmail);
            // --------------------------
            ccRight.appendChild(userName);
            ccRight.appendChild(divEmail);


            //criando a estrutura da div user
            var cardUser = document.createElement("div");
            cardUser.classList.add("card-content");
            cardUser.appendChild(divColLeft);
            cardUser.appendChild(ccRight);


            // divColLeft.appendChild(divAvatarMini);
            var divConteudo = document.getElementById("users");
            divConteudo.appendChild(cardUser);

            var hr = document.createElement("hr");
            hr.classList.add("hr");
            divConteudo.appendChild(hr);




          });
        }
      });




    </script>
  </footer>
</body>

</html>